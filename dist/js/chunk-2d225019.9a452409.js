(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d225019"],{e30e:function(t,a,s){"use strict";s.r(a);var e=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",[s("loading",{attrs:{active:t.isLoading},on:{"update:active":function(a){t.isLoading=a}}},[s("div",{staticClass:"loadingio-spinner-spin-ur5grgaunp"},[s("div",{staticClass:"ldio-dwsbgiuamos"},[s("div",[s("div")]),s("div",[s("div")]),s("div",[s("div")]),s("div",[s("div")]),s("div",[s("div")]),s("div",[s("div")]),s("div",[s("div")]),s("div",[s("div")])])])]),t._m(0),t._m(1),s("Cards",{attrs:{products:t.products},on:{getProducts:t.getProducts,getOneProduct:t.getOneProduct,addCart:t.addCart}}),t.cart.total>0?s("div",{staticClass:"col-md-10 py-2 border-top mx-auto lg",attrs:{id:"cart-list-lg"}},[t._m(2),s("table",{staticClass:"table table-striped table-bordered text-dark mt-4"},[t._m(3),s("tbody",t._l(t.cart.carts,(function(a){return s("tr",{key:a.id},[s("td",{staticClass:"align-middle"},[s("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{type:"button"},on:{click:function(s){return t.delCart(a.id)}}},[s("i",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true"}})])]),s("td",{staticClass:"align-middle"},[t._v(" "+t._s(a.product.title)+" "),t.cart.final_total!==t.cart.total?s("div",{staticClass:"text-muted"},[t._v(" 已套用優惠券 ")]):t._e()]),s("td",{staticClass:"align-middle"},[t._v(t._s(a.qty)+"/"+t._s(a.product.unit))]),s("td",{staticClass:"text-right"},[t.cart.final_total!==t.cart.total?s("del",{staticClass:"text-muted"},[t._v(" "+t._s(t._f("dollarSign")(t._f("numFormat")(a.total)))+" ")]):[t._v(" "+t._s(t._f("dollarSign")(t._f("numFormat")(a.total)))+" ")],t.cart.final_total!==t.cart.total?s("div",{staticClass:"text-dark"},[t._v(" 折扣後 "+t._s(t._f("dollarSign")(t._f("numFormat")(a.final_total)))+" ")]):t._e()],2)])})),0),s("tfoot",[s("tr",[s("td",{staticClass:"text-right",attrs:{colspan:"3"}},[t._v("總計")]),s("td",{staticClass:"text-right"},[t._v(" "+t._s(t._f("dollarSign")(t._f("numFormat")(t.cart.total)))+" ")])]),t.cart.final_total!==t.cart.total?s("tr",[s("td",{staticClass:"text-right text-muted",attrs:{colspan:"3"}},[t._v("折扣價")]),s("td",{staticClass:"text-right text-muted"},[t._v(" "+t._s(t._f("dollarSign")(t._f("numFormat")(t.cart.final_total)))+" ")])]):t._e()])]),s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.couponCode,expression:"couponCode"}],staticClass:"form-control",attrs:{type:"text",placeholder:"請輸入優惠碼"},domProps:{value:t.couponCode},on:{input:function(a){a.target.composing||(t.couponCode=a.target.value)}}}),s("button",{staticClass:"btn btn-dark w-25",attrs:{type:"button"},on:{click:t.addCoupon}},[t._v(" 套用優惠碼 ")])])]):t._e(),t.cart.total>0?s("div",{staticClass:"sm",attrs:{id:"cart-list-sm"}},[t._m(4),s("table",{staticClass:"table table-striped table-bordered text-dark mt-4"},[t._m(5),t._l(t.cart.carts,(function(a){return s("tbody",{key:a.id},[s("tr",[s("td",{staticClass:"align-middle"},[s("button",{staticClass:"btn btn-outline-dark btn-sm",attrs:{type:"button"},on:{click:function(s){return t.delCart(a.id)}}},[s("i",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true"}})])]),s("td",{staticClass:"text-center"},[s("div",{staticClass:"float-left"},[t._v(" "+t._s(a.product.title)+" × "+t._s(a.qty)+" ")]),s("div",{staticClass:"float-right"},[t.cart.final_total!==t.cart.total?s("del",{staticClass:"text-muted"},[t._v(" "+t._s(t._f("dollarSign")(t._f("numFormat")(a.total)))+" ")]):[t._v(" "+t._s(t._f("dollarSign")(t._f("numFormat")(a.total)))+" ")],t.cart.final_total!==t.cart.total?s("div",{staticClass:"text-dark"},[t._v(" 折扣後 "+t._s(t._f("dollarSign")(t._f("numFormat")(a.final_total)))+" ")]):t._e()],2),s("br"),t.cart.final_total!==t.cart.total?s("div",{staticClass:"text-muted text-left"},[t._v(" 已套用優惠券 ")]):t._e()])])])})),s("tfoot",[s("tr",{class:{"text-muted":t.cart.final_total!==t.cart.total}},[s("td",{staticClass:"text-right"},[t._v("總計")]),s("td",{staticClass:"text-right",attrs:{colspan:"2"}},[t._v(" "+t._s(t._f("dollarSign")(t._f("numFormat")(t.cart.total)))+" ")])]),t.cart.final_total!==t.cart.total?s("tr",[s("td",{staticClass:"pl-0 text-right text-dark"},[t._v("應付金額")]),s("td",{staticClass:"text-right text-dark"},[t._v(" "+t._s(t._f("dollarSign")(t._f("numFormat")(t.cart.final_total)))+" ")])]):t._e()])],2),t._m(6),s("div",{staticClass:"input-group input-group-sm p-0"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.couponCode,expression:"couponCode"}],staticClass:"form-control text-center",attrs:{type:"text",placeholder:"請輸入優惠碼"},domProps:{value:t.couponCode},on:{input:function(a){a.target.composing||(t.couponCode=a.target.value)}}})]),s("button",{staticClass:"btn btn-dark rounded-0 w-100 btn-sm font-weight-bold",attrs:{type:"button"},on:{click:t.addCoupon}},[t._v(" 套用優惠碼 ")])]):t._e(),s("hr"),0!==t.cart.total?s("div",{staticClass:"py-3"},[t._m(7),s("div",{staticClass:"row justify-content-center mx-3"},[s("div",{staticClass:"col-md-8 my-2 mx-auto"},[s("ValidationObserver",{ref:"form",scopedSlots:t._u([{key:"default",fn:function(a){var e=a.invalid;return[s("form",{staticClass:"text-dark text-left",on:{submit:function(a){return a.preventDefault(),t.addOrder(a)}}},[s("div",{staticClass:"form-group"},[s("ValidationProvider",{attrs:{name:"email",rules:"required|email"},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.failed,r=a.errors;return[s("label",{attrs:{for:"useremail"}},[t._v("電子信箱")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.email,expression:"form.user.email"}],staticClass:"form-control form-control-sm",class:{"is-invalid":e},attrs:{type:"text",name:"email",id:"useremail",placeholder:"請輸入收件人email"},domProps:{value:t.form.user.email},on:{input:function(a){a.target.composing||t.$set(t.form.user,"email",a.target.value)}}}),e?s("span",{staticClass:"text-danger"},[t._v(t._s(r[0]))]):t._e()]}}],null,!0)})],1),s("div",{staticClass:"form-row"},[s("div",{staticClass:"form-group col-md-5"},[s("ValidationProvider",{attrs:{name:"name",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.failed,r=a.errors;return[s("label",{attrs:{for:"username"}},[t._v("姓名")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.name,expression:"form.user.name"}],staticClass:"form-control form-control-sm",class:{"is-invalid":e},attrs:{type:"text",name:"name",id:"username",placeholder:"請輸入收件人姓名"},domProps:{value:t.form.user.name},on:{input:function(a){a.target.composing||t.$set(t.form.user,"name",a.target.value)}}}),e?s("span",{staticClass:"text-danger"},[t._v(" "+t._s(r[0])+" ")]):t._e()]}}],null,!0)})],1),s("div",{staticClass:"form-group col-md-7"},[s("ValidationProvider",{attrs:{name:"sm",rules:"required|numeric"},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.failed,r=a.errors;return[s("label",{attrs:{for:"usertel"}},[t._v("電話號碼")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.tel,expression:"form.user.tel"}],staticClass:"form-control form-control-sm",class:{"is-invalid":e},attrs:{type:"text",name:"sm",id:"usertel",placeholder:"請輸入收件人聯絡電話"},domProps:{value:t.form.user.tel},on:{input:function(a){a.target.composing||t.$set(t.form.user,"tel",a.target.value)}}}),e?s("span",{staticClass:"text-danger"},[t._v(" "+t._s(r[0])+" ")]):t._e()]}}],null,!0)})],1)]),s("div",{staticClass:"form-group"},[s("ValidationProvider",{attrs:{name:"address",rules:"required|min:3"},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.failed,r=a.errors;return[s("label",{attrs:{for:"useraddress"}},[t._v("收件地址")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.address,expression:"form.user.address"}],staticClass:"form-control form-control-sm",class:{"is-invalid":e},attrs:{type:"text",name:"address",id:"useraddress",placeholder:"請輸入收件人地址"},domProps:{value:t.form.user.address},on:{input:function(a){a.target.composing||t.$set(t.form.user,"address",a.target.value)}}}),e?s("span",{staticClass:"text-danger"},[t._v(t._s(r[0]))]):t._e()]}}],null,!0)})],1),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"message"}},[t._v("備註")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.message,expression:"form.message"}],staticClass:"form-control",attrs:{name:"message",id:"message",cols:"30",rows:"5",placeholder:"商品備註"},domProps:{value:t.form.message},on:{input:function(a){a.target.composing||t.$set(t.form,"message",a.target.value)}}})]),s("div",{staticClass:"text-right"},[s("button",{staticClass:"btn mt-3 btn-dark",attrs:{disabled:e}},[t._v(" 資料送出 ")])])])]}}],null,!1,2268518459)})],1)])]):t._e(),s("div",{staticClass:"modal fade",attrs:{id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[s("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[s("div",{staticClass:"modal-header bg-dark"},[s("h5",{staticClass:"modal-title text-white",attrs:{id:"exampleModalLabel"}},[t._v(" "+t._s(t.product.title)+" ")]),t._m(8)]),s("div",{staticClass:"modal-body"},[s("img",{staticClass:"img-fluid",attrs:{alt:"",src:t.product.imageUrl||t.product.image}}),s("blockquote",{staticClass:"blockquote mt-3"},[s("p",{staticClass:"mb-2"},[t._v(t._s(t.product.content))]),s("pre",{staticClass:"text-muted small"},[t._v(t._s(t.product.description))])]),s("hr"),s("div",{staticClass:"d-flex justify-content-between align-items-baseline"},[t.product.price?t._e():s("div",{staticClass:"h5"},[t._v(" "+t._s(t.product.origin_price)+" 元 ")]),t.product.price?s("del",{staticClass:"h6 text-muted"},[t._v(" 原價 "+t._s(t.product.origin_price)+" 元 ")]):t._e(),t.product.price?s("div",{staticClass:"h5 text-dark"},[t._v(" 現在只要 "+t._s(t.product.price)+" 元 ")]):t._e()]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.product.num,expression:"product.num"}],staticClass:"form-control mt-3",attrs:{name:""},on:{change:function(a){var s=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.product,"num",a.target.multiple?s:s[0])}}},t._l(10,(function(a){return s("option",{key:a,domProps:{value:a}},[t._v(" 選購 "+t._s(a)+" "+t._s(t.product.unit)+" ")])})),0)]),s("div",{staticClass:"modal-footer"},[s("div",{staticClass:"text-muted text-nowrap mr-3"},[t._v(" 小計 "),s("strong",[t._v(t._s(t.product.num*t.product.price))]),t._v(" 元 ")]),s("button",{staticClass:"btn btn-dark",attrs:{type:"button"},on:{click:function(a){return t.addCart(t.product.id,t.product.num)}}},[t._v(" 加入購物車 ")])])])])])],1)},r=[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"lg mt-5"},[s("div",{staticClass:"float-left"},[s("h4",{staticClass:"mt-3 font-weight-bold"},[s("i",{staticClass:"fa fa-th",attrs:{"aria-hidden":"true"}}),t._v(" 商品列表 ")])])])},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"sm"},[s("div",{staticClass:"float-left"},[s("h5",{staticClass:"mt-3 font-weight-bold"},[s("i",{staticClass:"fa fa-th",attrs:{"aria-hidden":"true"}}),t._v(" 商品列表 ")])])])},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("h4",{staticClass:"my-3"},[s("i",{staticClass:"fa fa-shopping-cart",attrs:{"aria-hidden":"true"}}),t._v(" 購物車清單 ")])},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("thead",{staticClass:"thead"},[s("th",[t._v("操作")]),s("th",[t._v("品名")]),s("th",[t._v("數量")]),s("th",[t._v("單價")])])},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("h5",[s("i",{staticClass:"fa fa-shopping-cart",attrs:{"aria-hidden":"true"}}),t._v(" 購物車清單")])},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("thead",{staticClass:"thead"},[s("th",{attrs:{width:"80"}},[t._v("操作")]),s("th",{attrs:{colspan:"2"}},[t._v("商品內容")])])},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("h5",[s("i",{staticClass:"fa fa-ticket",attrs:{"aria-hidden":"true"}}),t._v(" 優惠券 ")])},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("h4",{staticClass:"my-3"},[s("i",{staticClass:"fa fa-shopping-bag",attrs:{"aria-hidden":"true"}}),t._v(" 填寫收件人 "),s("span",{staticClass:"text-danger my-2"},[t._v("* 為必填項目")])])},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[s("span",{staticClass:"text-white",attrs:{"aria-hidden":"true"}},[t._v("×")])])}],i=(s("99af"),s("7db0"),s("1157")),o=s.n(i),n=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",[s("div",{staticClass:"row d-inline-flex text-dark"},t._l(t.products,(function(a){return s("div",{key:a.id,staticClass:"col-lg-4 col-md-6 mb-4"},[s("div",{staticClass:"card border-0 shadow-sm"},[s("img",{staticStyle:{width:"100%",height:"250px","object-fit":"contain"},attrs:{src:""+(a.imageUrl||a.image),alt:""}}),s("div",{staticClass:"card-body"},[s("h5",{staticClass:"card-title m-0"},[t._v(t._s(a.title))]),s("span",{staticClass:"badge badge-secondary p-1"},[t._v(t._s(a.category))]),s("p",{staticClass:"card-text"},[t._v(t._s(a.content))]),s("div",{staticClass:"d-flex justify-content-between align-items-baseline"},[a.price?t._e():s("div",{staticClass:"h5"},[t._v(" "+t._s(a.origin_price)+" 元 ")]),a.price?s("del",{staticClass:"h6 text-muted m-auto"},[t._v(" 原價$"+t._s(a.origin_price)+" ")]):t._e(),a.price?s("div",{staticClass:"h5 text-dark m-auto"},[t._v(" 現在只要$"+t._s(a.price)+" ")]):t._e()])]),s("div",{staticClass:"card-footer d-flex"},[s("button",{staticClass:"btn border border-dark btn-sm",attrs:{type:"button"},on:{click:function(s){return t.getOneProduct(a.id)}}},[t._v(" 查看更多 ")]),s("button",{staticClass:"btn btn-dark btn-sm ml-auto",attrs:{type:"button"},on:{click:function(s){return t.addCart(a.id)}}},[t._v(" 加到購物車 ")])])])])})),0)])},d=[],l={data:function(){return{}},props:["products"],methods:{getProducts:function(){this.$emit("getProducts")},getOneProduct:function(t){this.$emit("getOneProduct",t)},addCart:function(t){this.$emit("addCart",t)}},created:function(){this.$emit("getProducts")}},c=l,u=s("2877"),m=Object(u["a"])(c,n,d,!1,null,null,null),p=m.exports,v={data:function(){return{products:[],isLoading:!1,product:{},status:{loadingItem:""},cart:[],couponCode:"",form:{user:{address:"",email:"",name:"",tel:""},message:""}}},methods:{getProducts:function(){var t=this;t.isLoading=!0;var a="".concat("https://vue-course-api.hexschool.io/","api/").concat("wangxuan","/products/all");t.$http.get(a).then((function(a){t.isLoading=!1,a.data.success?t.products=a.data.products:t.$bus.$emit("message:push",a.data.message,"danger")}))},getOneProduct:function(t){var a=this;a.isLoading=!0,a.status.loadingItem=t;var s="".concat("https://vue-course-api.hexschool.io/","api/").concat("wangxuan","/product/").concat(t);a.$http.get(s).then((function(t){t.data.success?(a.product=t.data.product,a.product.num=1,o()("#productModal").modal("show"),a.isLoading=!1):a.$bus.$emit("message:push",t.data.message,"danger"),a.status.loadingItem=""}))},addCart:function(t){var a,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e=this,r=e.cart.carts.find((function(a){return a.product_id===t}));if(r){a={product_id:r.product_id,qty:s+r.qty},e.isLoading=!0;var i="".concat("https://vue-course-api.hexschool.io/","api/").concat("wangxuan","/cart");e.$http.post(i,{data:a}).then((function(t){e.isLoading=!1,t.data.success?e.delCart(r.id,!0):e.$bus.$emit("message:push",t.data.message,"danger")}))}else{a={product_id:t,qty:s},e.isLoading=!0;var o="".concat("https://vue-course-api.hexschool.io/","api/").concat("wangxuan","/cart");e.$http.post(o,{data:a}).then((function(t){e.isLoading=!1,t.data.success?(e.getCart(),e.$bus.$emit("message:push",t.data.message,"dark")):e.$bus.$emit("message:push",t.data.message,"danger")}))}},getCart:function(){var t=this;t.isLoading=!0;var a="".concat("https://vue-course-api.hexschool.io/","api/").concat("wangxuan","/cart");t.$http.get(a).then((function(a){a.data.success?t.cart=a.data.data:t.$bus.$emit("message:push",a.data.message,"danger"),o()("#productModal").modal("hide"),t.isLoading=!1}))},delCart:function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=this;s.isLoading=!0;var e="".concat("https://vue-course-api.hexschool.io/","api/").concat("wangxuan","/cart/").concat(t);s.$http.delete(e).then((function(t){t.data.success?!1===a?s.$bus.$emit("message:push",t.data.message,"dark"):s.$bus.$emit("message:push","購物車清單已更新","dark"):s.$bus.$emit("message:push",t.data.message,"danger"),s.isLoading=!1,s.getCart()}))},addCoupon:function(){var t=this;t.isLoading=!0;var a="".concat("https://vue-course-api.hexschool.io/","api/").concat("wangxuan","/coupon");""===t.couponCode&&(t.couponCode="false"),t.$http.post(a,{data:{code:t.couponCode}}).then((function(a){a.data.success?t.cart.final_total=a.data.final_total:t.$bus.$emit("message:push",a.data.message,"danger"),t.getCart(),t.isLoading=!1,t.couponCode=""}))},addOrder:function(){var t=this;t.isLoading=!0;var a="".concat("https://vue-course-api.hexschool.io/","api/").concat("wangxuan","/order");t.$refs.form.validate().then((function(s){s?t.$http.post(a,{data:t.form}).then((function(a){a.data.success?(o()("#modal").modal("hide"),t.$router.push("/test/test_checkout/".concat(a.data.orderId)),t.$bus.$emit("message:push",a.data.message,"dark")):t.$bus.$emit("message:push",a.data.message,"danger")})):t.$bus.$emit("message:push","欄位不完整","danger"),t.getCart(),t.isLoading=!1}))},goCart:function(){o()("html,body").animate({scrollTop:o()("#cart-list-lg").offset().top},800)}},created:function(){this.getProducts(),this.getCart()},components:{Cards:p}},f=v,_=Object(u["a"])(f,e,r,!1,null,null,null);a["default"]=_.exports}}]);
//# sourceMappingURL=chunk-2d225019.9a452409.js.map